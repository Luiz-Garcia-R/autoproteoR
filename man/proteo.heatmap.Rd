% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/proteoheatmap.R
\name{proteo.heatmap}
\alias{proteo.heatmap}
\title{Volcano Heatmap of Proteomics Data}
\usage{
proteo.heatmap(
  normalized_data,
  metadata,
  group_colname = "Group",
  top_n = 100,
  cluster_rows = TRUE,
  cluster_cols = TRUE,
  show_rownames = FALSE,
  show_colnames = TRUE,
  palette = (grDevices::colorRampPalette(c("navy", "white", "firebrick3")))(100),
  results = FALSE,
  assign_result = FALSE,
  assign_name = "heatmap_data",
  envir = parent.frame(),
  help = FALSE
)
}
\arguments{
\item{normalized_data}{A \code{data.frame} or \code{proteoNorm} object containing normalized protein abundances.
Must include a column named \code{ProteinID}.}

\item{metadata}{A \code{data.frame} with at least two columns:
\itemize{
\item \code{Sample}: matching the column names in \code{normalized_data}
\item \code{Group}: group assignment for each sample
}}

\item{group_colname}{Column name in \code{metadata} containing group information. Default = \code{"Group"}.}

\item{top_n}{Integer. Number of most variable proteins to include. Default = 100.}

\item{cluster_rows}{Logical. Whether to cluster rows in the heatmap. Default = TRUE.}

\item{cluster_cols}{Logical. Whether to cluster columns in the heatmap. Default = TRUE.}

\item{show_rownames}{Logical. Show protein IDs in the heatmap. Default = FALSE.}

\item{show_colnames}{Logical. Show sample names in the heatmap. Default = TRUE.}

\item{palette}{Color palette for the heatmap. Default = blue-white-red.}

\item{results}{Logical. If TRUE, returns a list with selected proteins and data. Default = FALSE.}

\item{assign_result}{Logical. If TRUE, assigns the result to the environment. Default = FALSE.}

\item{assign_name}{Name of the object to assign if \code{assign_result = TRUE}. Default = \code{"heatmap_data"}.}

\item{envir}{Environment where the result will be assigned. Default = \code{parent.frame()}.}

\item{help}{Logical. If TRUE, prints this help message and example usage. Default = FALSE.}
}
\value{
If \code{results = TRUE}, returns a list with:
\describe{
\item{top_proteins}{Vector of top selected proteins.}
\item{expr_z_score}{Z-scored expression matrix.}
\item{annotation_col}{Sample annotations for the heatmap.}
}
If \code{assign_result = TRUE}, the same list is assigned to the chosen environment.
Otherwise, only the heatmap is displayed.
}
\description{
Creates a heatmap of the top most variable proteins across samples or groups.
Automatically applies per-protein z-scoring, selects the most variable proteins,
and annotates samples by group. Returns the selected proteins and data if requested.
}
\examples{
\dontrun{
# Small example dataset
raw_data <- data.frame(
  ProteinID = c('P1','P2','P3','P4'),
  Control_1 = c(6.2,0,4.5,3.1),
  Control_2 = c(6.1,0,4.8,3.3),
  Treatment_1 = c(5.9,0,5.0,2.9),
  Treatment_2 = c(6.0,0,4.9,3.0)
)

metadata <- data.frame(
  Sample = c('Control_1','Control_2','Treatment_1','Treatment_2'),
  Group  = c('Control','Control','Treatment','Treatment')
)

# Step 1: Normalize data
normalized_obj <- proteo.normalize(raw_data, metadata)

# Step 2: Generate heatmap
proteo.heatmap(normalized_obj, metadata, top_n = 3)
proteo.heatmap(normalized_obj, metadata, top_n = 3, results = TRUE)
}

}
\references{
Kolde R (2019). pheatmap: Pretty Heatmaps. R package version 1.0.12.
}
